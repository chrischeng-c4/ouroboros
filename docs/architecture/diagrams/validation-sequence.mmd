sequenceDiagram
    participant PY as Python Layer
    participant P3 as PyO3 Bridge
    participant RS as Rust Layer
    participant MG as MongoDB

    Note over PY: User defines model with type hints
    PY->>PY: class User(Document):<br/>name: str, age: int

    Note over PY: Create instance (no validation)
    PY->>PY: user = User(name="Alice", age=25)
    Note over PY: Type hints only<br/>No runtime validation yet

    Note over PY: Trigger validation
    PY->>P3: await user.save()

    Note over P3: Extract Python data<br/>(minimal GIL hold)
    P3->>P3: extract_dict_items(py, dict)

    Note over P3: GIL released here!
    P3->>RS: items (Send + Sync)

    Note over RS: Type validation<br/>(GIL-free, fast)
    RS->>RS: items_to_bson_document()
    Note over RS: str→String, int→Int64<br/>float→Double, etc.

    Note over RS: Security validation<br/>(GIL-free)
    RS->>RS: validate_document()
    Note over RS: Collection name check<br/>Field name check ($)<br/>Size limits (16MB)<br/>Depth limits (100)

    Note over RS: Send to MongoDB
    RS->>MG: insert_one(bson_doc)

    MG-->>RS: Result / Error
    RS-->>P3: Success / ValidationError
    P3-->>PY: Return / Raise

    Note over PY: Error messages same quality<br/>as Pydantic, but 10x faster!
