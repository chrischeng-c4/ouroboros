[tox]
envlist = py312, lint, typecheck
isolated_build = true

[testenv]
deps =
    pytest>=7.4.0
    pytest-asyncio>=0.21.0
    pytest-cov>=4.1.0
    pytest-mock>=3.12.0
commands =
    pytest {posargs:python/tests}

[testenv:lint]
deps =
    ruff>=0.1.0
    pylint>=3.0.0
    black>=23.0.0
    isort>=5.12.0
commands =
    ruff check python/
    pylint python/data_bridge
    black --check python/
    isort --check-only python/

[testenv:typecheck]
deps =
    mypy>=1.8.0
    types-redis>=4.6.0
    pydantic>=2.5.0
commands =
    mypy python/

[testenv:format]
deps =
    black>=23.0.0
    isort>=5.12.0
    ruff>=0.1.0
commands =
    black python/
    isort python/
    ruff check --fix python/

[testenv:coverage]
deps =
    {[testenv]deps}
    coverage[toml]>=7.3.0
commands =
    coverage run -m pytest python/tests/
    coverage report
    coverage html